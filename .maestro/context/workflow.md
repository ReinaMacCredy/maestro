# Workflow Configuration

> Source of truth for how `/maestro:implement` executes tasks.
> Generated by `/maestro:setup`. Edit directly to customize.

## Methodology
TDD (Test-Driven Development)

### TDD Lifecycle
1. **Red**: Write failing test that defines expected behavior
2. **Green**: Write minimum code to make the test pass
3. **Refactor**: Improve code quality with green tests as safety net
4. Rerun tests after refactor to confirm still passing

## Quality Targets
- **Test coverage**: 80%
- **CI-aware**: Use `CI=true` prefix for watch-mode tools (jest, vitest, etc.)

## Quality Gates Checklist

Before marking any phase as complete, verify ALL of the following:

- [ ] All new code has corresponding tests
- [ ] Test coverage meets or exceeds threshold (80%)
- [ ] No new lint warnings or errors
- [ ] Type checking passes (if applicable)
- [ ] No hardcoded secrets, tokens, or credentials
- [ ] Error handling covers expected failure modes
- [ ] Input validation at all system boundaries
- [ ] API contracts match specification
- [ ] Documentation updated for public API changes
- [ ] No TODO/FIXME items left unresolved in changed files

## Testing Requirements

### Unit Tests
- Pure logic and transformations
- Edge cases and boundary values
- Error paths and exception handling

### Integration Tests
- Cross-module communication
- File system operations
- Script execution flows

## Commit Strategy
- **Frequency**: Per-task
- **Format**: `{type}({scope}): {description}` (conventional commits)
- **Summary storage**: Git notes

### Commit Types
| Type | Use When |
|------|----------|
| `feat` | New feature or capability |
| `fix` | Bug fix |
| `docs` | Documentation changes only |
| `style` | Formatting, no code change |
| `refactor` | Code restructuring, no behavior change |
| `test` | Adding or updating tests only |
| `chore` | Build, tooling, infrastructure |

### Git Notes Format
```
Task: {task_name}
Phase: {phase_number}
Changes: {files_changed}
Summary: {what_and_why}
```

Command: `git notes add -m "{note}" {commit_hash}`

## Self-Review Checklist

Before committing, verify:

### Functionality
- [ ] Code does what the spec requires
- [ ] Edge cases handled
- [ ] No regressions in existing behavior

### Code Quality
- [ ] Naming is clear and consistent
- [ ] No unnecessary complexity
- [ ] No code duplication
- [ ] Functions are focused (single responsibility)

### Testing
- [ ] Tests cover the change
- [ ] Tests are deterministic (no flaky tests)
- [ ] Test names describe expected behavior

### Security
- [ ] No SQL/command injection vectors
- [ ] Auth/authz checks present where needed
- [ ] Sensitive data not logged

## Phase Completion Protocol
1. **Coverage check**: Run coverage for files changed since last checkpoint
2. **Test execution**: Run full test suite (`CI=true`)
   - Max 2 fix attempts on failure
   - If still failing: halt and ask user
3. **Manual verification**: Present step-by-step verification plan to user
4. **User confirmation**: Wait for explicit approval before next phase

## Definition of Done

A task/phase/track is "done" when ALL of the following are true:

1. Implementation matches the acceptance criteria in spec.md
2. All tests pass (unit + integration)
3. Coverage meets threshold (80%)
4. No lint errors or type errors
5. Code reviewed (self-review checklist completed)
6. Commit(s) created with proper conventional commit messages
7. Plan.md updated with completion SHA
8. Manual verification steps confirmed by user
9. No unresolved TODOs in changed code

## Development Commands

```bash
# Setup
npx skills add ReinaMacCredy/maestro

# Testing
bash scripts/test-hooks.sh
bash -n scripts/*.sh

# Validation
PLUGIN_VERSION=$(jq -r '.version' .claude-plugin/plugin.json); MARKETPLACE_VERSION=$(jq -r '.plugins[0].version' .claude-plugin/marketplace.json); [ "$PLUGIN_VERSION" = "$MARKETPLACE_VERSION" ]

# Changelog
git-cliff --unreleased --strip header
git-cliff -o CHANGELOG.md
```
