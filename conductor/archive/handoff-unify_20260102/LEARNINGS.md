# Learnings: handoff-unify_20260102

<!-- Auto-generated by /conductor-finish -->

## Commands

- `/conductor-handoff` - Unified handoff command with auto-detect (replaces /create_handoff and /resume_handoff)
- `/conductor-handoff create` - Force CREATE mode with Beads sync and progress tracking
- `/conductor-handoff resume` - Force RESUME mode with Beads context loading

## Gotchas

- Auto-detect mode uses 7-day threshold: first message + recent handoff = RESUME, else CREATE
- Handoff Beads sync saves context to bd notes for compaction-proof resumability
- Agent Mail primary, markdown secondary: Send handoffs to Agent Mail first for FTS5 search, write markdown for git history
- File deletion must wait for new files to be created and referenced
- Stale handoffs (>7 days) trigger warning on /resume_handoff

## Patterns

- **9-Step CREATE Mode:** Detect → Parallel Check → Metadata → Secrets → Agent Mail → Beads Sync → Markdown → metadata.json → Activity
- **9-Step RESUME Mode:** Parse → Agent Mail → File Discovery → Load → Beads Context → Validate → Present → Todos → Activity
- **Unified Command Pattern:** Single command with subcommands replaces multiple separate commands
- **Hybrid Storage:** Agent Mail for search (FTS5), markdown for git history
- **Progress Tracking in metadata.json:** handoff.status, section_count, progress_percent, last_handoff, history[]

---

**Source threads:**

- T-019b7e06-a216-7607-93c0-e26de9ee9e41: Implementing handoff unification track
