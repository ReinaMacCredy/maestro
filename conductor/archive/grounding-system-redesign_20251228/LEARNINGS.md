# Learnings: grounding-system-redesign_20251228

<!-- Auto-generated by /conductor-finish -->

## Commands

- `bd create "..." -t epic -p 0` - Create epic with priority 0
- `bd create "..." -t task -p <priority>` - Create task issues
- `bd dep add <issue-id> <parent-id>` - Wire dependencies between issues
- `bd close <id1> <id2> --reason completed` - Close multiple beads at once
- `./scripts/validate-links.sh <dir>` - Validate markdown links in directory

## Gotchas

- **All sources fail at MANDATORY**: Must block with `MANUAL_VERIFY` action, not silently proceed
- **Timeout handling**: Return partial results + warning (soft limits), not hard failure
- **Subagent timeout**: Fall back to grounding-only, skip impact scan
- **Network failure**: Graceful fallback to repo-only mode
- **Conflict resolution**: Auto-prefer highest confidence BUT show conflict summary in output
- **Implementation order matters**: Router depends on tiers, enforcement depends on grounding result

## Patterns

- **Hybrid Tiered Grounding**: Light (1 source, 3s) → Mini (1-2 sources, 5s) → Standard (cascade, 10s) → Full (all + impact scan, 45s)
- **Cascading Router**: REPO → WEB → HISTORY, stop early on high confidence
- **Enforcement Levels**: Advisory (log) → Gatekeeper (block if missing) → Mandatory (block if fails/low confidence)
- **Impact Scan Subagent**: Parallel execution with full grounding at DELIVER phase
- **Track-level persistence**: `conductor/tracks/{track-id}/grounding/` for incremental results
- **Schema v1.1**: Includes routing details, conflicts array, overall_confidence, enforcement_action

---

**Source threads:**
- T-019b64cb-906f-7188-8a16-fbdd23d523de: Design session + newtrack
