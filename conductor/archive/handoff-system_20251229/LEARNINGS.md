# Learnings: handoff-system_20251229

<!-- Auto-generated by /conductor-finish -->

## Commands

- `/create_handoff` - Create handoff file manually
- `/resume_handoff` - Load most recent handoff for track
- `/resume_handoff <path>` - Resume specific handoff file
- `/resume_handoff <track-id>` - Resume latest from track
- `/conductor-handoff` - Alias for create/resume (subcommand style)

## Gotchas

- Handoffs in `conductor/handoffs/<track>/` are git-committed (shareable), archived on `/conductor-finish`
- Stale handoffs (>7 days) trigger warning on `/resume_handoff`
- Session continuity is automatic via workflow entry points (`ds`, `/conductor-implement`, `/conductor-finish`)
- Validation state tracked in `metadata.json.validation`, not LEDGER.md
- Ad-hoc queries (not triggering `ds`, `/conductor-implement`, etc.) do NOT load handoff history - intentional low-overhead behavior for casual chats
- Local `skills/continuity/SKILL.md` stub overrides marketplace plugin to redirect to handoff commands
- Index corruption handled by auto-repair logic in `/resume_handoff`
- Parallel agent writes use millisecond timestamps + collision suffix for safety
- Idle detection uses message-triggered prompt (not timer) after 30min gap via `.last_activity` marker

## Patterns

- **Workflow-Aware Continuity:** Handoffs tied to entry points (`ds`, `/conductor-implement`, `/conductor-finish`) not generic session events
- **6 Auto-Triggers:** design-end, epic-start, epic-end, pre-finish, manual, idle
- **Hybrid File Strategy:** Individual files per handoff + index.md for consolidated log view (append-only, sorted on read)
- **Humanlayer-Inspired Format:** 4 lean sections (Context, Changes, Learnings, Next Steps) instead of 7 - beads handles task tracking
- **State File Consolidation:** Validation state in metadata.json.validation replaces LEDGER.md frontmatter
- **File Naming:** `YYYY-MM-DD_HH-MM-SS-mmm_<track>_<trigger>.md` with millisecond precision

---

**Source threads:**

- T-019b6a9b-f406-71c8-8415-50ccbc7cb9fc: Design + newtrack
- T-019b6ae1-6fa8-717d-8a54-31ce452613a9: Implementation (Phases 3-4)
