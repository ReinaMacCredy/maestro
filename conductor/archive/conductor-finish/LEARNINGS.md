# Learnings: conductor-finish

<!-- Auto-generated by /conductor-finish -->

## Commands

- `bd compact --analyze --json` - Find beads needing summaries
- `bd compact --apply --id <id> --summary "<text>"` - Apply AI summary to bead
- `bd count --status closed --json` - Count closed beads for cleanup threshold
- `bd cleanup --older-than 0 --limit <n> --force` - Remove oldest closed beads

## Gotchas

- Epic 4 (deleting doc-sync) must wait for Epic 2 (replacing references) - deleting too early causes broken references
- Phase 3 (Knowledge Merge) is required - if it fails, stop workflow
- Phases 1 & 2 are best-effort - failures should log warnings but continue

## Patterns

- **4-Phase Workflow:** Thread Compaction → Beads Compaction → Knowledge Merge → Archive
- **Smart Skip:** Each phase checks if work exists before running (no threads = skip Phase 1)
- **Resume Capability:** `finish-state.json` tracks progress for interrupted workflows
- **Parallel Epic Pattern:** Epics 2 and 3 can run in parallel when no file conflicts
- **S/H/K Archive Choice:** Soft (metadata only) / Hard (move to archive/) / Keep (stay active)

---
**Source threads:**
- T-019b4b29-7199-75dc-912a-c7328a626a41: Design session for /conductor-finish integration
- T-019b4ba6-4748-75f0-821c-d1e2f73620a6: Plan execution and task completion
